---
name: Security Vulnerability
about: Report a security vulnerability (use email for sensitive issues)
title: '[SECURITY] '
labels: security
assignees: ''
---

⚠️ **STOP**: If this is a **serious security vulnerability**, please **DO NOT** file a public issue.

**Instead, please follow our responsible disclosure process:**
1. Email: [Your security contact email - update in SECURITY.md]
2. Include: Detailed description, steps to reproduce, potential impact
3. Wait for acknowledgment before public disclosure
4. Coordinate disclosure timeline with maintainers

See [SECURITY.md](../../SECURITY.md) for full security policy.

---

## Security Issue Type
Select the type(s) that apply:

- [ ] Information Disclosure (sensitive data exposed)
- [ ] Input Validation (injection, XSS, path traversal)
- [ ] Authentication/Authorization (bypass, privilege escalation)
- [ ] Dependency Vulnerability (vulnerable package)
- [ ] Configuration Issue (insecure default, missing hardening)
- [ ] Cryptographic Weakness (weak algorithm, improper key management)
- [ ] API Security (rate limiting, excessive permissions)
- [ ] Data Protection (encryption, PII handling)
- [ ] Other: _______

## Severity Assessment
Based on CVSS scoring:

- [ ] **Critical** (CVSS 9.0-10.0) - Immediate action required
- [ ] **High** (CVSS 7.0-8.9) - Urgent remediation needed
- [ ] **Medium** (CVSS 4.0-6.9) - Should be fixed soon
- [ ] **Low** (CVSS 0.1-3.9) - Minor issue, can be scheduled

**CVSS Score** (if calculated): _______

## Description
Provide a clear description of the security issue.

**What is vulnerable?**:
- Component/Module: [e.g., PowerShell module M365CIS.psm1, Python module openai_gpt5.py]
- Affected versions: [e.g., v1.0.0 - v1.2.0]
- Affected functions: [e.g., Connect-M365CIS, load_json_with_bom]

**What is the vulnerability?**:
[Describe the security flaw]

## Impact
What is the potential impact of this vulnerability?

- **Confidentiality**: [None/Low/Medium/High] - Can attacker access sensitive data?
- **Integrity**: [None/Low/Medium/High] - Can attacker modify data or system?
- **Availability**: [None/Low/Medium/High] - Can attacker disrupt service?

**Realistic Attack Scenario**:
```
[Describe a realistic scenario where this could be exploited]
```

**Data at Risk**:
- [ ] Client financial data
- [ ] Authentication credentials
- [ ] PII (Personally Identifiable Information)
- [ ] Audit evidence
- [ ] System configuration
- [ ] Other: _______

## Affected Components
Which parts of the toolkit are affected?

- [ ] PowerShell modules (M365CIS.psm1)
- [ ] Python core modules (src/core/*)
- [ ] Python integrations (src/integrations/*)
- [ ] MCP servers (src/extensions/mcp/, src/mcp/)
- [ ] GitHub Actions (action.yml, workflows)
- [ ] Documentation/Examples
- [ ] Dependencies (external packages)
- [ ] Other: _______

## Steps to Reproduce
**⚠️ CAUTION**: Only include steps if this issue is low severity and safe to disclose publicly.

For high/critical vulnerabilities, email details directly to security contact.

1. Step one
2. Step two
3. Step three

**Proof of Concept** (if applicable):
```python
# Example code demonstrating the vulnerability (sanitize sensitive data)
```

## Environment
Where can this vulnerability be exploited?

- **Deployment Type**: [Local development, GitHub Actions, Production deployment]
- **Operating System**: [Windows, Linux, macOS]
- **Python Version**: [e.g., 3.11.5]
- **PowerShell Version**: [e.g., 7.3.0]
- **Network Environment**: [Isolated, Corporate network, Internet-facing]

## Suggested Fix
If you have suggestions for fixing this issue:

**Remediation Approach**:
1. Short-term fix (hotfix):
   ```
   [Code/config changes for immediate mitigation]
   ```

2. Long-term fix (proper solution):
   ```
   [Architectural changes for complete resolution]
   ```

**Testing Approach**:
- [ ] Unit tests to verify fix
- [ ] Integration tests for regression
- [ ] Security scanning (Bandit, Safety, etc.)

## CPA/Compliance Impact
Does this vulnerability affect compliance requirements?

- [ ] **SOX Compliance**: Could affect audit trail integrity or control effectiveness
- [ ] **AICPA Trust Services**: Impacts security, availability, or confidentiality criteria
- [ ] **Client Data Protection**: Could expose client financial/tax data
- [ ] **Audit Evidence**: Could compromise audit evidence integrity
- [ ] **Not compliance-related**

**Compliance Details**:
```
[Explain which compliance requirements are impacted]
```

## Detection & Indicators
How can users detect if they are affected?

**Log Indicators**:
```
[Grep patterns or log entries that indicate exploitation]
```

**File/System Indicators**:
```
[Files, processes, or system states that indicate compromise]
```

## Workaround
Is there a temporary workaround while waiting for a fix?

- [ ] Yes - described below
- [ ] No known workaround

**Workaround Instructions**:
```
[Step-by-step instructions for temporary mitigation]
```

## Have you already contacted the security team?
- [ ] Yes, this is a follow-up to private disclosure
- [ ] No, this is low severity and safe to discuss publicly

**If yes, provide reference**: [Email date, ticket number, etc.]

## Additional Information
Any other information that would help assess or fix this vulnerability.

**References**:
- CVE ID (if assigned): 
- Related vulnerabilities: 
- External advisories: 

---

## For Maintainers Only

**Triage Checklist**:
- [ ] Severity confirmed
- [ ] Affected versions identified
- [ ] Fix assigned to developer
- [ ] Security advisory drafted (if public disclosure)
- [ ] CVE requested (if critical/high)
- [ ] Patch release scheduled
- [ ] Users notified (if applicable)
- [ ] Documentation updated

**Fix Timeline**:
- Discovery Date: 
- Acknowledgment Date: 
- Fix Development Date: 
- Patch Release Date: 
- Public Disclosure Date: 
