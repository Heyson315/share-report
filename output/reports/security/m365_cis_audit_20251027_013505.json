[
    {
        "ControlId":  "CIS-EXO-1",
        "Title":  "Ensure modern auth is enabled and basic auth blocked (EXO)",
        "Severity":  "High",
        "Expected":  "OAuth2 enabled; All Basic Auth protocols disabled via Authentication Policies",
        "Actual":  "OAuth2ClientProfileEnabled=True; BasicAllowed=False",
        "Status":  "Pass",
        "Evidence":  "",
        "Reference":  "CIS M365 Foundations v3.0 L1; EXO Auth Policies",
        "Timestamp":  "2025-10-27T01:46:40"
    },
    {
        "ControlId":  "CIS-EXO-2",
        "Title":  "Disable external auto-forwarding (TransportConfig)",
        "Severity":  "High",
        "Expected":  "ExternalClientForwardingDisabled=True",
        "Actual":  "ExternalClientForwardingDisabled=",
        "Status":  "Fail",
        "Evidence":  "\r\n\r\nAddressBookPolicyRoutingEnabled                             : False\r\nAllowLegacyTLSClients                                       : False\r\nAnonymousSenderToRecipientRatePerHour                       : 1800\r\nClearCategories                                             : True\r\nConvertDisclaimerWrapperToEml                               : False\r\nDSNConversionMode                                           : PreserveDSNBody\r\nJournalArchivingEnabled                                     : False\r\nEnableExternalHTTPMailDelivery                              : False\r\nExternalDelayDsnEnabled                                     : True\r\nExternalDsnDefaultLanguage                                  : \r\nExternalDsnLanguageDetectionEnabled                         : True\r\nExternalDsnMaxMessageAttachSize                             : 10 MB (10,485,760 bytes)\r\nExternalDsnReportingAuthority                               : \r\nExternalDsnSendHtml                                         : True\r\nExternalPostmasterAddress                                   : \r\nGenerateCopyOfDSNFor                                        : {}\r\nHygieneSuite                                                : Premium\r\nInternalDelayDsnEnabled                                     : True\r\nInternalDsnDefaultLanguage                                  : \r\nInternalDsnLanguageDetectionEnabled                         : True\r\nInternalDsnMaxMessageAttachSize                             : 10 MB (10,485,760 bytes)\r\nInternalDsnReportingAuthority                               : \r\nInternalDsnSendHtml                                         : True\r\nInternalSMTPServers                                         : {}\r\nJournalMessageExpirationDays                                : 0\r\nJournalingReportNdrTo                                       : \u003c\u003e\r\nLegacyJournalingMigrationEnabled                            : False\r\nLegacyArchiveJournalingEnabled                              : False\r\nLegacyArchiveLiveJournalingEnabled                          : False\r\nRedirectUnprovisionedUserMessagesForLegacyArchiveJournaling : False\r\nRedirectDLMessagesForLegacyArchiveJournaling                : False\r\nMaxDumpsterSizePerDatabase                                  : 18 MB (18,874,368 bytes)\r\nMaxDumpsterTime                                             : 7.00:00:00\r\nMaxReceiveSize                                              : Unlimited\r\nMaxRecipientEnvelopeLimit                                   : Unlimited\r\nMaxSendSize                                                 : Unlimited\r\nMessageExpiration                                           : 1.00:00:00\r\nMigrationEnabled                                            : True\r\nOpenDomainRoutingEnabled                                    : False\r\nRfc2231EncodingEnabled                                      : False\r\nSafetyNetHoldTime                                           : 7.00:00:00\r\nSmtpClientAuthenticationDisabled                            : False\r\nSupervisionTags                                             : {Reject, Allow}\r\nTLSReceiveDomainSecureList                                  : {}\r\nTLSSendDomainSecureList                                     : {}\r\nVerifySecureSubmitEnabled                                   : False\r\nVoicemailJournalingEnabled                                  : True\r\nHeaderPromotionModeSetting                                  : NoCreate\r\nXexch50Enabled                                              : True\r\n\r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; EXO TransportConfig",
        "Timestamp":  "2025-10-27T01:46:41"
    },
    {
        "ControlId":  "CIS-EXO-3",
        "Title":  "Ensure mailbox auditing is enabled",
        "Severity":  "Medium",
        "Expected":  "Organization AuditDisabled=False",
        "Actual":  "AuditDisabled=False",
        "Status":  "Pass",
        "Evidence":  "\r\n\r\nOrganizationId                                            : NAMPR12A012.PROD.OUTLOOK.COM/Microsoft Exchange Hosted \r\n                                                            Organizations/RahmanFinanceandAccounting.onmicrosoft.com - NAMPR12A012.PROD.OUTLOOK.COM/\r\n                                                            ConfigurationUnits/RahmanFinanceandAccounting.onmicrosoft.com/Configuration\r\nName                                                      : RahmanFinanceandAccounting.onmicrosoft.com\r\nIdentity                                                  : RahmanFinanceandAccounting.onmicrosoft.com\r\nGuid                                                      : c02ef67a-ed41-4083-b20f-bd444d82a337\r\nObjectVersion                                             : 16500\r\nDelayedDelicensingEnabledState                            : Enabled: False; WhenLastModifiedUtc: 1/1/0001 12:00:00 AM\r\nTenantAdminNotificationForDelayedDelicensingState         : Enabled: False; WhenLastModifiedUtc: 1/1/0001 12:00:00 AM\r\nEndUserMailNotificationForDelayedDelicensingState         : Enabled: False; WhenLastModifiedUtc: 1/1/0001 12:00:00 AM\r\nDelayedDelicensingBlockedExplicitlyState                  : Enabled: False; WhenLastModifiedUtc: 1/1/0001 12:00:00 AM\r\nDefaultPublicFolderAgeLimit                               : \r\nDefaultPublicFolderIssueWarningQuota                      : 1.7 GB (1,825,361,920 bytes)\r\nDefaultPublicFolderProhibitPostQuota                      : 2 GB (2,147,483,648 bytes)\r\nDefaultPublicFolderMaxItemSize                            : Unlimited\r\nDefaultPublicFolderDeletedItemRetention                   : 30.00:00:00\r\nDefaultPublicFolderMovedItemRetention                     : 7.00:00:00\r\nPublicFoldersLockedForMigration                           : False\r\nPublicFolderMigrationComplete                             : False\r\nPublicFolderMailboxesLockedForNewConnections              : False\r\nPublicFolderMailboxesMigrationComplete                    : False\r\nPublicFolderShowClientControl                             : False\r\nPublicFoldersEnabled                                      : Local\r\nActivityBasedAuthenticationTimeoutEnabled                 : True\r\nActivityBasedAuthenticationTimeoutInterval                : 06:00:00\r\nActivityBasedAuthenticationTimeoutWithSingleSignOnEnabled : True\r\nAppsForOfficeEnabled                                      : True\r\nAppsForOfficeCorpCatalogAppsCount                         : 5\r\nPrivateCatalogAppsCount                                   : 5\r\nAVAuthenticationService                                   : \r\nCustomerFeedbackEnabled                                   : \r\nDistributionGroupDefaultOU                                : \r\nDistributionGroupNameBlockedWordsList                     : {}\r\nDistributionGroupNamingPolicy                             : \r\nEwsAllowEntourage                                         : \r\nEwsAllowList                                              : \r\nEwsAllowMacOutlook                                        : \r\nEwsAllowOutlook                                           : \r\nDisablePlusAddressInRecipients                            : False\r\nRejectDirectSend                                          : False\r\nMaskClientIpInReceivedHeadersEnabled                      : True\r\nEwsApplicationAccessPolicy                                : \r\nEwsBlockList                                              : \r\nAutodiscoverPartialDirSync                                : False\r\nEwsEnabled                                                : \r\nIPListBlocked                                             : {}\r\nElcProcessingDisabled                                     : False\r\nAutoExpandingArchiveEnabled                               : False\r\nComplianceMLBgdCrawlEnabled                               : False\r\nExchangeNotificationEnabled                               : True\r\nExchangeNotificationRecipients                            : {}\r\nHierarchicalAddressBookRoot                               : \r\nIndustry                                                  : NotSpecified\r\nMailTipsAllTipsEnabled                                    : True\r\nMailTipsExternalRecipientsTipsEnabled                     : True\r\nMailTipsGroupMetricsEnabled                               : True\r\nMailTipsLargeAudienceThreshold                            : 25\r\nMailTipsMailboxSourcedTipsEnabled                         : True\r\nManagedFolderHomepage                                     : \r\nMicrosoftExchangeRecipientEmailAddresses                  : {SMTP:MicrosoftExchange329e71ec88ae4615bbc36ab6ce41109e@RahmanFinanceandAccounting.onmic\r\n                                                            rosoft.com}\r\nMicrosoftExchangeRecipientEmailAddressPolicyEnabled       : False\r\nMicrosoftExchangeRecipientPrimarySmtpAddress              : MicrosoftExchange329e71ec88ae4615bbc36ab6ce41109e@RahmanFinanceandAccounting.onmicrosoft\r\n                                                            .com\r\nMicrosoftExchangeRecipientReplyRecipient                  : \r\nForwardSyncLiveIdBusinessInstance                         : False\r\nOrganizationSummary                                       : {}\r\nReadTrackingEnabled                                       : False\r\nSCLJunkThreshold                                          : 4\r\nSIPAccessService                                          : \r\nSIPSessionBorderController                                : \r\nMaxConcurrentMigrations                                   : Unlimited\r\nMaxAddressBookPolicies                                    : \r\nMaxOfflineAddressBooks                                    : \r\nMaxInformationBarrierSegmentsLegacy                       : \r\nMaxInformationBarrierSegments                             : 5000\r\nMaxInformationBarrierBridges                              : 5000\r\nInformationBarriersManagementEnabled                      : False\r\nInformationBarriersEnforcementEnabled                     : False\r\nInformationBarriersRestrictPeopleSearch                   : True\r\nUpgradeIBInProgress                                       : False\r\nInformationBarrierMode                                    : Legacy\r\nIsExcludedFromOnboardMigration                            : False\r\nIsExcludedFromOffboardMigration                           : False\r\nIsFfoMigrationInProgress                                  : False\r\nExternalCloudAccessEnabled                                : False\r\nIsProcessEhaMigratedMessagesEnabled                       : False\r\nTenantRelocationsAllowed                                  : False\r\nACLableSyncedObjectEnabled                                : False\r\nPreferredInternetCodePageForShiftJis                      : 0\r\nRequiredCharsetCoverage                                   : 100\r\nByteEncoderTypeFor7BitCharsets                            : 0\r\nPublicComputersDetectionEnabled                           : False\r\nRmsoSubscriptionStatus                                    : Unknown\r\nIntuneManagedStatus                                       : True\r\nAzurePremiumSubscriptionStatus                            : False\r\nHybridConfigurationStatus                                 : Unknown\r\nReleaseTrack                                              : StagedRollout\r\nCompassEnabled                                            : \r\nSharePointUrl                                             : https://rahmanfinanceandaccounting.sharepoint.com/\r\nMapiHttpEnabled                                           : False\r\nRealTimeLogServiceEnabled                                 : False\r\nCustomerLockboxEnabled                                    : False\r\nOAuth2ClientProfileEnabled                                : True\r\nPerTenantSwitchToESTSEnabled                              : False\r\nLinkPreviewEnabled                                        : True\r\nOutlookPayEnabled                                         : True\r\nConnectorsEnabled                                         : True\r\nConnectorsActionableMessagesEnabled                       : True\r\nSmtpActionableMessagesEnabled                             : True\r\nOfficeGraphActivitySharingOrgOptout                       : False\r\nUnblockUnsafeSenderPromptEnabled                          : True\r\nAsyncSendEnabled                                          : True\r\nRefreshSessionEnabled                                     : False\r\nIsAgendaMailEnabled                                       : True\r\nNetworkThrottlingConfiguration                            : \r\nBookingsEnabled                                           : True\r\nBookingsEnabledLastUpdateTime                             : 01/01/01 12:00:00 AM\r\nBookingsPaymentsEnabled                                   : False\r\nBookingsSocialSharingRestricted                           : False\r\nBookingsAddressEntryRestricted                            : False\r\nBookingsAuthEnabled                                       : False\r\nBookingsCreationOfCustomQuestionsRestricted               : False\r\nBookingsExposureOfStaffDetailsRestricted                  : False\r\nBookingsNotesEntryRestricted                              : False\r\nBookingsPhoneNumberEntryRestricted                        : False\r\nBookingsMembershipApprovalRequired                        : False\r\nBookingsSmsMicrosoftEnabled                               : True\r\nBookingsNamingPolicyEnabled                               : False\r\nBookingsBlockedWordsEnabled                               : False\r\nBookingsNamingPolicyPrefixEnabled                         : False\r\nBookingsNamingPolicyPrefix                                : \r\nBookingsNamingPolicySuffixEnabled                         : False\r\nBookingsNamingPolicySuffix                                : \r\nBookingsSearchEngineIndexDisabled                         : False\r\nLeanPopoutEnabled                                         : False\r\nOutlookMobileHelpShiftEnabled                             : True\r\nOutlookMobileSingleAccountEnabled                         : False\r\nOutlookMobileGCCRestrictionsEnabled                       : False\r\nElevatedAccessControl                                     : \r\nAuditDisabled                                             : False\r\nWebPushNotificationsDisabled                              : False\r\nWebSuggestedRepliesDisabled                               : False\r\nConnectorsEnabledForOutlook                               : True\r\nConnectorsEnabledForOutlookLastUpdateTime                 : 01/01/01 12:00:00 AM\r\nConnectorsEnabledForTeams                                 : True\r\nConnectorsEnabledForTeamsLastUpdateTime                   : 01/01/01 12:00:00 AM\r\nConnectorsEnabledForSharepoint                            : True\r\nConnectorsEnabledForSharepointLastUpdateTime              : 01/01/01 12:00:00 AM\r\nConnectorsEnabledForYammer                                : True\r\nConnectorsEnabledForYammerLastUpdateTime                  : 01/01/01 12:00:00 AM\r\nAutoEnableArchiveMailbox                                  : False\r\nOnlineMeetingsByDefaultEnabled                            : \r\nSendFromAliasEnabled                                      : True\r\nOutlookTextPredictionDisabled                             : False\r\nMobileAppEducationEnabled                                 : True\r\nEnableForwardingAddressSyncForMailboxes                   : False\r\nOutlookGifPickerDisabled                                  : False\r\nWorkspaceTenantEnabled                                    : True\r\nBasicAuthBlockedApps                                      : 767\r\nShortenEventScopeDefault                                  : None\r\nDefaultMinutesToReduceShortEventsBy                       : 5\r\nDefaultMinutesToReduceLongEventsBy                        : 10\r\nFindTimeAttendeeAuthenticationEnabled                     : False\r\nFindTimeOnlineMeetingOptionDisabled                       : False\r\nFindTimeAutoScheduleDisabled                              : False\r\nFindTimeLockPollForAttendeesEnabled                       : False\r\nMessageRemindersEnabled                                   : True\r\nIsEopTrialEnabled                                         : False\r\nEnableOutlookEvents                                       : False\r\nIsComplianceTrialEnabled                                  : False\r\nDataInsightsFlag                                          : 4093640694\r\nMessageHighlightsEnabled                                  : True\r\nSharedDomainEmailAddressFlowEnabled                       : True\r\nHybridRSVPEnabled                                         : True\r\nPostponeRoamingSignaturesUntilLater                       : False\r\nTwoClickMailPreviewEnabled                                : False\r\nMessageRecallMaxRecallableAge                             : 365.00:00:00\r\nRPSEnabled                                                : False\r\nEwsOperationAccessPolicyEnabled                           : \r\nEwsOperationAccessPolicyAllowList                         : \r\nEwsOperationAccessPolicyPopulated                         : False\r\nBlockExchangeProvisioningFromOnPremEnabled                : False\r\nEnforceShortenEventSettingEffectiveTime                   : \r\nDLPWaitOnSendEnabled                                      : False\r\nDLPWaitOnSendTimeout                                      : 0\r\nInRegionRoutingEnabled                                    : False\r\nOrganizationConfigHash                                    : fJHNTsMwDIBfpeoJDkubwZCQsk5TqwkugBDsbtK0tdQ4VX4mxqtx4JF4BVJ64adwsmN/8mcr769vYvOs++SgrEND\r\n                                                            65SzPE0USVMjtes0+GbBL9JNIary6vhksS4NNdgGCz7yhbh2FXgoFXlliwcblMi+lcS21kgVuqGH436yFDlb5skJ\r\n                                                            X8XALperM8b5qcjmyDj/cWgtjNvc2hYIXybxDnr36ZpvizurDmiCm9fzUX/OxiRneXT/h4utlGrwqq6MBozvKd6A\r\n                                                            VkXX2YUcgEmjRfalPscE9ydyD50G2iEBSQVUR6MJ5ONVzJBGaY0zjf9tyX6uls1/0wcAAAD//wMA\r\nLegacyExchangeDN                                          : /o=ExchangeLabs/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=exotemplatee34f58b\r\n                                                            c-eb3e-47ed-a4a8-b8b47893ca9d.com/cn=Configuration\r\nDisplayName                                               : Rahman Finance and Accounting P.L.LC.\r\nHeuristics                                                : None\r\nResourceAddressLists                                      : {\\All Rooms}\r\nIsMixedMode                                               : True\r\nPreviousAdminDisplayVersion                               : 0.10 (14.0.100.0)\r\nIsAddressListPagingEnabled                                : True\r\nForeignForestFQDN                                         : {}\r\nForeignForestOrgAdminUSGSid                               : \r\nForeignForestRecipientAdminUSGSid                         : \r\nForeignForestViewOnlyAdminUSGSid                          : \r\nMimeTypes                                                 : {}\r\nIsLicensingEnforced                                       : True\r\nIsTenantAccessBlocked                                     : False\r\nIsDualWriteEnabled                                        : True\r\nIsTenantInGracePeriod                                     : False\r\nIsDehydrated                                              : False\r\nIsGuidPrefixedLegacyDnDisabled                            : False\r\nIsMailboxForcedReplicationDisabled                        : False\r\nRBACConfigurationVersion                                  : 0.1 (15.20.9253.11)\r\nRootPublicFolderMailbox                                   : \r\nRemotePublicFolderMailboxes                               : {}\r\nAdminDisplayVersion                                       : 0.20 (15.20.9253.11)\r\nIsUpgradingOrganization                                   : False\r\nIsUpdatingServicePlan                                     : False\r\nServicePlan                                               : BPOS_S_E15_0\r\nTargetServicePlan                                         : \r\nWACDiscoveryEndpoint                                      : \r\nAdfsAuthenticationConfiguration                           : \r\nAdfsIssuer                                                : \r\nAdfsAudienceUris                                          : {}\r\nAdfsSignCertificateThumbprints                            : {}\r\nAdfsEncryptCertificateThumbprint                          : \r\nSiteMailboxCreationURL                                    : \r\nDefaultDataEncryptionPolicy                               : \r\nMailboxDataEncryptionEnabled                              : False\r\nDefaultAuthenticationPolicy                               : \r\nAllowedMailboxRegions                                     : {nam=namprd12.prod.outlook.com}\r\nDefaultMailboxRegion                                      : nam\r\nCurrentMailboxForests                                     : {namprd12.prod.outlook.com}\r\nIsJitEnabled                                              : \r\nAutoJitForests                                            : \r\nDefaultMailboxRegionLastUpdateTime                        : 03/30/24 06:34:13 PM\r\nAllowedMailboxRegionsLastUpdateTime                       : 03/30/24 06:34:13 PM\r\nDirectReportsGroupAutoCreationEnabled                     : False\r\nAllowToAddGuests                                          : True\r\nGuestsEnabled                                             : True\r\nGroupsCreationEnabled                                     : True\r\nHiddenMembershipGroupsCreationEnabled                     : False\r\nGroupsCreationWhitelistedId                               : \r\nGroupsUsageGuidelinesLink                                 : \r\nDefaultGroupAccessType                                    : Private\r\nGroupLifeCyclePolicy                                      : \u003cGroupLifeCyclePolicy\u003e\u003cGroupLifetimeInDays\u003e-1\u003c/GroupLifetimeInDays\u003e\u003cManagedGroupType \r\n                                                            p2:nil=\"true\" xmlns:p2=\"http://www.w3.org/2001/XMLSchema-instance\" \r\n                                                            /\u003e\u003cLastUpdatedTime\u003e2025-10-25T22:41:50.8823719Z\u003c/LastUpdatedTime\u003e\u003c/GroupLifeCyclePolicy\u003e\r\nGroupsNamingPolicy                                        : \r\nDataClassifications                                       : \u003cDataClassifications /\u003e\r\nVisibleMeetingUpdateProperties                            : Location,AllProperties:15\r\nMatchSenderOrganizerProperties                            : False\r\nDisableMailboxForSubstrateOnlyFinished                    : False\r\nInPlaceHolds                                              : {}\r\nServiceInstanceMove                                       : \r\nGuestsUsageGuidelinesLink                                 : \r\nOrganizationPrivacyStatementLink                          : https://hhr-cpa.com/privacy\r\nIsMIPLabelForGroupsEnabled                                : False\r\nIsGroupFoldersAndRulesEnabled                             : False\r\nBlockMoveMessagesForGroupFolders                          : False\r\nFocusedInboxOn                                            : \r\nFocusedInboxOnLastUpdateTime                              : 01/01/01 12:00:00 AM\r\nForestConfigVersion                                       : \r\nForestConfigLastRunTime                                   : 01/01/01 12:00:00 AM\r\nEndUserDLUpgradeFlowsDisabled                             : False\r\nOcmGroupId                                                : \r\nIsGroupMemberAllowedToEditContent                         : False\r\nRecallReadMessagesEnabled                                 : \r\nMessageRecallEnabled                                      : \r\nMessageRecallAlertRecipientsEnabled                       : False\r\nMessageRecallAlertRecipientsReadMessagesOnlyEnabled       : False\r\nAutomaticForcedReadReceiptEnabled                         : False\r\nActionableMessagesExtenalAccessTokenEnabled               : False\r\nId                                                        : First Organization\r\nIsValid                                                   : True\r\nExchangeVersion                                           : 0.1 (8.0.535.0)\r\nDistinguishedName                                         : CN=Configuration,CN=RahmanFinanceandAccounting.onmicrosoft.com,CN=ConfigurationUnits,DC=\r\n                                                            NAMPR12A012,DC=PROD,DC=OUTLOOK,DC=COM\r\nObjectCategory                                            : NAMPR12A012.PROD.OUTLOOK.COM/Configuration/Schema/ms-Exch-Configuration-Unit-Container\r\nObjectClass                                               : {top, container, msExchOrganizationContainer, msExchConfigurationUnitContainer}\r\nWhenChanged                                               : 10/27/25 01:15:01 AM\r\nWhenCreated                                               : 03/30/24 02:33:55 PM\r\nWhenChangedUTC                                            : 10/27/25 05:15:01 AM\r\nWhenCreatedUTC                                            : 03/30/24 06:33:55 PM\r\nExchangeObjectId                                          : 7cd5b2d5-2236-409a-9a61-3574d74e2264\r\nOrganizationalUnitRoot                                    : RahmanFinanceandAccounting.onmicrosoft.com\r\nOriginatingServer                                         : SN4PR12A12DC003.NAMPR12A012.PROD.OUTLOOK.COM\r\nObjectState                                               : Changed\r\n\r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; EXO Auditing",
        "Timestamp":  "2025-10-27T01:46:41"
    },
    {
        "ControlId":  "CIS-EXO-4",
        "Title":  "Ensure legacy protocols disabled per mailbox (sample check)",
        "Severity":  "Medium",
        "Expected":  "Legacy protocols (POP/IMAP/MAPI) disabled on all mailboxes",
        "Actual":  "MailboxesWithLegacyProtocols=2 (sample of 100)",
        "Status":  "Fail",
        "Evidence":  "\r\nDisplayName              PopEnabled ImapEnabled MAPIEnabled\r\n-----------              ---------- ----------- -----------\r\nDiscovery Search Mailbox       True        True        True\r\nHassan Rahman                  True        True        True\r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; EXO Mailbox Protocols",
        "Timestamp":  "2025-10-27T01:46:41"
    },
    {
        "ControlId":  "CIS-SPO-1",
        "Title":  "Restrict SharePoint external sharing (Tenant)",
        "Severity":  "High",
        "Expected":  "Restrictive external sharing",
        "Actual":  "Unknown",
        "Status":  "Manual",
        "Evidence":  "No connection available. Use Connect-SPOService before running this CmdLet.",
        "Reference":  "CIS M365 Foundations v3.0 L1; SPO Sharing",
        "Timestamp":  "2025-10-27T01:46:45"
    },
    {
        "ControlId":  "CIS-AAD-1",
        "Title":  "Limit Global Administrator role assignments",
        "Severity":  "High",
        "Expected":  "Global Admin assignments minimal (\u003c= 2-4)",
        "Actual":  "GlobalAdminCount=3",
        "Status":  "Pass",
        "Evidence":  "\r\nPrincipalId                          RoleDefinitionId                    \r\n-----------                          ----------------                    \r\n6b633c09-7475-4647-9bcc-f59732ec625f 62e90394-69f5-4237-9190-012177145e10\r\n727d96b1-4aab-47bc-b62d-3ee40c1d73bb 62e90394-69f5-4237-9190-012177145e10\r\n2912f341-f9ff-4f03-ad74-721dbf070c4f 62e90394-69f5-4237-9190-012177145e10\r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; AAD Roles",
        "Timestamp":  "2025-10-27T01:46:54"
    },
    {
        "ControlId":  "CIS-DEF-1",
        "Title":  "Ensure Safe Links policy is enabled",
        "Severity":  "High",
        "Expected":  "At least one Safe Links rule or policy is enabled",
        "Actual":  "EnabledRules=0; EnabledPolicies=0",
        "Status":  "Fail",
        "Evidence":  "\r\nName                                        Enabled\r\n----                                        -------\r\nStrict Preset Security Policy1713470629399         \r\nStandardRecommendedPolicy638480795407067709        \r\nBuilt-In Protection Policy                         \r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; Defender for Office",
        "Timestamp":  "2025-10-27T01:46:54"
    },
    {
        "ControlId":  "CIS-DEF-2",
        "Title":  "Ensure Safe Attachments policy is enabled",
        "Severity":  "High",
        "Expected":  "At least one Safe Attachments policy enabled",
        "Actual":  "EnabledPolicies=3",
        "Status":  "Pass",
        "Evidence":  "\r\nName                                        Enable\r\n----                                        ------\r\nStrict Preset Security Policy1713470628358    True\r\nStandardRecommendedPolicy638480795383316441   True\r\nBuilt-In Protection Policy                    True\r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; Defender for Office",
        "Timestamp":  "2025-10-27T01:46:55"
    },
    {
        "ControlId":  "CIS-CA-1",
        "Title":  "Ensure Conditional Access MFA policy exists for all users",
        "Severity":  "High",
        "Expected":  "At least one enabled CA policy requiring MFA for all users",
        "Actual":  "MFAPolicies=5",
        "Status":  "Pass",
        "Evidence":  "\r\nDisplayName                                               State  \r\n-----------                                               -----  \r\nRequire multifactor authentication for guest access       enabled\r\nRequire multifactor authentication for all users          enabled\r\nconditional access 1`                                     enabled\r\nRequire multifactor authentication for ‎Azure‎ management enabled\r\nRequire multifactor authentication for Azure management   enabled\r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; Conditional Access",
        "Timestamp":  "2025-10-27T01:46:56"
    },
    {
        "ControlId":  "CIS-PURVIEW-1",
        "Title":  "Ensure DLP policies are enabled for data protection",
        "Severity":  "High",
        "Expected":  "DLP policies enabled",
        "Actual":  "Unknown",
        "Status":  "Manual",
        "Evidence":  "Not connected to Purview or DLP cmdlets unavailable",
        "Reference":  "CIS M365 Foundations v3.0 L1; Purview DLP",
        "Timestamp":  "2025-10-27T01:46:56"
    },
    {
        "ControlId":  "CIS-AAD-2",
        "Title":  "Ensure Azure AD Identity Protection risk policies are configured",
        "Severity":  "High",
        "Expected":  "At least one risk-based CA policy enabled (user or sign-in risk)",
        "Actual":  "RiskBasedPolicies=0",
        "Status":  "Fail",
        "Evidence":  "",
        "Reference":  "CIS M365 Foundations v3.0 L1; AAD Identity Protection",
        "Timestamp":  "2025-10-27T01:46:56"
    },
    {
        "ControlId":  "CIS-INTUNE-1",
        "Title":  "Ensure Intune device compliance policies exist and are enforced",
        "Severity":  "Medium",
        "Expected":  "Compliance policies configured",
        "Actual":  "Unknown",
        "Status":  "Manual",
        "Evidence":  "Intune cmdlets unavailable or insufficient permissions",
        "Reference":  "CIS M365 Foundations v3.0 L1; Intune MDM",
        "Timestamp":  "2025-10-27T01:47:00"
    },
    {
        "ControlId":  "CIS-AAD-3",
        "Title":  "Ensure guest user access restrictions are configured",
        "Severity":  "Medium",
        "Expected":  "Guest user role is restrictive (not Member role)",
        "Actual":  "GuestUserRoleId=a0b1b346-4d3e-4e8b-98f8-753987be4970",
        "Status":  "Fail",
        "Evidence":  "\r\nDeletedDateTime Description                                                       DisplayName          Id                  AllowEmailVerifiedUsersTo\r\n                                                                                                                           JoinOrganization         \r\n--------------- -----------                                                       -----------          --                  -------------------------\r\n                Used to manage authorization related settings across the company. Authorization Policy authorizationPolicy True                     \r\n\r\n\r\n",
        "Reference":  "CIS M365 Foundations v3.0 L1; AAD Guest Access",
        "Timestamp":  "2025-10-27T01:47:00"
    },
    {
        "ControlId":  "CIS-PURVIEW-2",
        "Title":  "Ensure audit logs are retained for compliance (90+ days recommended)",
        "Severity":  "Medium",
        "Expected":  "Audit log retention 90+ days",
        "Actual":  "Unknown",
        "Status":  "Manual",
        "Evidence":  "Not connected to Purview or audit cmdlets unavailable",
        "Reference":  "CIS M365 Foundations v3.0 L1; Purview Auditing",
        "Timestamp":  "2025-10-27T01:47:00"
    },
    {
        "ControlId":  "CIS-PURVIEW-3",
        "Title":  "Ensure sensitivity labels are published and enforced",
        "Severity":  "Medium",
        "Expected":  "Sensitivity labels published",
        "Actual":  "Unknown",
        "Status":  "Manual",
        "Evidence":  "Not connected to Purview or label cmdlets unavailable",
        "Reference":  "CIS M365 Foundations v3.0 L1; Purview Information Protection",
        "Timestamp":  "2025-10-27T01:47:00"
    }
]
