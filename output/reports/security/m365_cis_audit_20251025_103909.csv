# Replace YYYYMMDD_HHMMSS with the actual timestamp from the audit run
& "C:\Users\HassanRahman\OneDrive - Rahman Finance and Accounting P.L.LC\share report\.venv\Scripts\python.exe" "C:\Users\HassanRahman\OneDrive - Rahman Finance and Accounting P.L.LC\share report\scripts\m365_cis_report.py" --input "C:\Users\HassanRahman\OneDrive - Rahman Finance and Accounting P.L.LC\share report\output\reports\security\m365_cis_audit_YYYYMMDD_HHMMSS.json"

& "C:\Users\HassanRahman\OneDrive - Rahman Finance and Accounting P.L.LC\share report\.venv\Scripts\python.exe" "C:\Users\HassanRahman\OneDrive - Rahman Finance and Accounting P.L.LC\share report\scripts\inspect_cis_report.py" --report "C:\Users\HassanRahman\OneDrive - Rahman Finance and Accounting P.L.LC\share report\output\reports\security\m365_cis_audit_YYYYMMDD_HHMMSS.xlsx""ControlId","Title","Severity","Expected","Actual","Status","Evidence","Reference","Timestamp"
"CIS-EXO-1","Ensure modern auth is enabled and basic auth blocked (EXO)","High","OAuth2 on; basic off","Unknown","Manual","Not connected to EXO","CIS M365 Foundations v3.0 L1; EXO Auth Policies","2025-10-25T10:39:10"
"CIS-EXO-2","Disable external auto-forwarding (TransportConfig)","High","External forwarding disabled","Unknown","Manual","Not connected to EXO","CIS M365 Foundations v3.0 L1; EXO TransportConfig","2025-10-25T10:39:10"
"CIS-EXO-3","Ensure mailbox auditing is enabled","Medium","Mailbox auditing enabled","Unknown","Manual","Not connected to EXO","CIS M365 Foundations v3.0 L1; EXO Auditing","2025-10-25T10:39:10"
"CIS-EXO-4","Ensure legacy protocols disabled per mailbox (sample check)","Medium","Legacy protocols disabled","Unknown","Manual","Not connected to EXO","CIS M365 Foundations v3.0 L1; EXO Mailbox Protocols","2025-10-25T10:39:10"
"CIS-SPO-1","Restrict SharePoint external sharing (Tenant)","High","Restrictive external sharing","Unknown","Manual","No connection available. Use Connect-SPOService before running this CmdLet.","CIS M365 Foundations v3.0 L1; SPO Sharing","2025-10-25T10:39:10"
"CIS-AAD-1","Limit Global Administrator role assignments","High","Minimal GA assignments","Unknown","Manual","Not connected to Graph","CIS M365 Foundations v3.0 L1; AAD Roles","2025-10-25T10:39:11"
"CIS-DEF-1","Ensure Safe Links policy is enabled","High","Safe Links enabled","Unknown","Manual","Not connected to EXO","CIS M365 Foundations v3.0 L1; Defender for Office","2025-10-25T10:39:11"
"CIS-DEF-2","Ensure Safe Attachments policy is enabled","High","Safe Attachments enabled","Unknown","Manual","Not connected to EXO","CIS M365 Foundations v3.0 L1; Defender for Office","2025-10-25T10:39:11"
"CIS-CA-1","Ensure Conditional Access MFA policy exists for all users","High","MFA policy enabled","Unknown","Manual","Not connected to Graph","CIS M365 Foundations v3.0 L1; Conditional Access","2025-10-25T10:39:11"

